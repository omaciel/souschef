{% extends "base.html" %}
{% load i18n %}

{% block extracss %}
<link rel="stylesheet" href="{{ MEDIA_URL }}css/ui-darkness/jquery-ui-1.8.10.custom.css" type="text/css" media="screen" />
{% endblock %}
{% block extrajs %}
<script src="{{ MEDIA_URL }}js/codemirror/js/codemirror.js" type="text/javascript"></script>
<script src="{{ MEDIA_URL }}js/jquery-ui-1.8.10.custom.min.js" type="text/javascript"></script>
<script src="{{ MEDIA_URL }}js/jquery.autocomplete.js" type="text/javascript"></script>
<script src="{{ MEDIA_URL }}js/jquery.recipe_sync.js" type="text/javascript"></script>
{% endblock %}

{% block content %}
<br>
<h1>{% trans "Edit recipe" %}</h1>
<br>
{% if file_error %}
<div class="file_error rc">
    {{file_error}}
</div>
<br>
{% endif %}
<div id="add_new_recipe">
    <h4>Recipe data</h4>
    <br>
    <form action="/aboyeur/recipes/edit/{{recipe.id}}/" method="post" enctype="multipart/form-data">
		{% csrf_token %}
        <fieldset>
			{{form.title.label_tag}}
            <br>
			{{form.title}}
            <br>
			{{form.body.label_tag}}
            <a href="#" id="recipe_sync"><img src="{{ MEDIA_URL }}images/sync.png" width="22"/></a>
            <br>
            <img src="{{ MEDIA_URL }}images/spinner.gif" style="display:none" id="spinner" />
            <div id="sync_status"></div>
            <div id="sync-confirm" title="Are you sure you want to replace current recipe body with a synced one from the repos ?">
            </div>
            <br>
            <div id="recipe_body">
				{{form.body}}
            </div>
            <br>
			{{form.install_path.label_tag}}
            <br>
			{{form.install_path}}
            <br>
			{{form.url.label_tag}}
            <br>
			{{form.url}}
            <br>
			{{form.published.label_tag}}
            <br>
			{{form.published}}
            <br>
			{{form.tags.label_tag}}  (separated by commas)
            <br>
			{{form.tags}}
        </fieldset>
        <br>
        <div class="proper_links">
		Attachement (Limit 500kb, accepted : zip, tar, tar.gz, tar.bz2) :
            <br>
		{% if recipe.recipe_file_set.all %}
		Current (will be deleted if sumbitted) :
		{% for recipe_file in recipe.recipe_file_set.all %}
            <a href="{{ MEDIA_URL }}{{recipe_file.file}}">
		{{recipe_file.filename}}
            </a>
            <br>
		{% endfor %}
		{% endif %}
		{{file_form.file.errors}}
		{{file_form.file}}
        </div>
        <br>
        <input type="submit" value="Save" />
    </form>
</div><!--end add_new_recipe-->
{% endblock %}
